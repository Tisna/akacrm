(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1054:function(t,e,r){"use strict";r.r(e);var n=r(28),o=r(23),c=(r(84),r(4),r(10),r(31),r(9),r(63),r(255),r(797)),base=(r(795),r(835)),d=r(853),l=r(555),j=r(950);r(29);var m,h,f,w,v,y,O,_=r(803),R=r(802),I=r(541),x=r(589),data=r(603),k=r(846),D=r(600),$=r(562),E=r(546),C=r(553),object=r(540),z=r(584),T=r(581),P=r(542),A=r(563),F=r(578),W=r(587),N=r(588),S=r(585),U=r(601),H=r(1033);Object(d.a)(),y=base.a,(O="undefined"!=typeof window&&window.jQuery)&&(O.fn.handsontable=function(t){var output,e=this.first(),r=e.data("handsontable");if("string"!=typeof t){var n=t||{};return r?r.updateSettings(n):(r=new y.Core(e[0],n),e.data("handsontable",r),r.init()),e}if(r){if(void 0===r[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var o,c=arguments.length,d=new Array(c>1?c-1:0),l=1;l<c;l++)d[l-1]=arguments[l];output=(o=r[t]).call.apply(o,[r].concat(d)),"destroy"===t&&e.removeData()}return output}),base.a.__GhostTable=_.a,base.a._getListenersCounter=l.b,base.a._getRegisteredMapsCounter=j.b,base.a.EventManager=l.a;var L=[I,x,data,k,D,$,E,C,object,z,T,R],G=[P,A];base.a.helper={},base.a.dom={},I.arrayEach(L,(function(t){I.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(base.a.helper[e]=t[e])}))})),I.arrayEach(G,(function(t){I.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(base.a.dom[e]=t[e])}))})),base.a.cellTypes=null!==(m=base.a.cellTypes)&&void 0!==m?m:{},I.arrayEach(Object(S.b)(),(function(t){base.a.cellTypes[t]=Object(S.a)(t)})),base.a.cellTypes.registerCellType=S.d,base.a.cellTypes.getCellType=S.a,base.a.editors=null!==(h=base.a.editors)&&void 0!==h?h:{},I.arrayEach(Object(F.c)(),(function(t){base.a.editors["".concat(z.toUpperCaseFirst(t),"Editor")]=Object(F.a)(t)})),base.a.editors.registerEditor=F.e,base.a.editors.getEditor=F.a,base.a.renderers=null!==(f=base.a.renderers)&&void 0!==f?f:{},I.arrayEach(Object(W.a)(),(function(t){var e=Object(W.b)(t);"base"===t&&(base.a.renderers.cellDecorator=e),base.a.renderers["".concat(z.toUpperCaseFirst(t),"Renderer")]=e})),base.a.renderers.registerRenderer=W.d,base.a.renderers.getRenderer=W.b,base.a.validators=null!==(w=base.a.validators)&&void 0!==w?w:{},I.arrayEach(Object(N.a)(),(function(t){base.a.validators["".concat(z.toUpperCaseFirst(t),"Validator")]=Object(N.b)(t)})),base.a.validators.registerValidator=N.d,base.a.validators.getValidator=N.b,base.a.plugins=null!==(v=base.a.plugins)&&void 0!==v?v:{},I.arrayEach(Object(U.b)(),(function(t){base.a.plugins[t]=Object(U.a)(t)})),base.a.plugins["".concat(z.toUpperCaseFirst(H.a.PLUGIN_KEY),"Plugin")]=H.a,base.a.plugins.registerPlugin=U.d,base.a.plugins.getPlugin=U.a;var M=base.a,V=r(1025),J=r(1036),K=r(1040),Q=r(1032),B=r(1043),X=r(1057),Y=r(1050),Z=r(1124),tt=r(1122),et=r(1123),at=r(1034),st=r(1044);r(816);Object(S.d)(V.a),Object(S.d)(J.a),Object(S.d)(K.a),Object(U.d)(Q.a),Object(U.d)(B.a),Object(U.d)(X.a),Object(U.d)(Y.a),Object(U.d)(Z.a),Object(U.d)(tt.a),Object(U.d)(et.a),Object(U.d)(at.a),Object(U.d)(st.a);var nt={name:"TableDetail",components:{HotTable:c.a},data:function(){return{settings:{licenseKey:"non-commercial-and-evaluation"},detailsRoot:"detailsRoot",colHeaders:[],form:{}}},created:function(){this.setInstance()},methods:{setInstance:function(){window.details=this},removeRow:function(t){this.$refs.details.hotInstance.alter("remove_row",t)},addLine:function(){var t=this.$refs.details.hotInstance.countRows();this.$refs.details.hotInstance.alter("insert_row",t+1)},updateTableSettings:function(header){this.$refs.details.hotInstance.updateSettings({currentRowClassName:"currentRow",currentColClassName:"currentCol",startRows:2,rowHeaders:!0,manualColumnResize:!0,rowHeights:28,filters:!0,autoColumnSize:!0,viewportRowRenderingOffset:1e3,viewportColumnRenderingOffset:100,colWidths:80,persistentState:!0,width:"100%",stretchH:"all",hiddenColumns:{copyPasteEnabled:!1,indicator:!1,columns:[1,2,3]},colHeaders:["","Id","Item ID","Item Code","Item Name","Description","Qty","Units","Curency","Unit Price","Discount","Tax","Amount",""],columns:[{width:"24px",wordWrap:!1,renderer:function(t,td,e,col,r,n,o){var button=null,c=window.details;return(button=document.createElement("button")).type="button",button.innerText=">",button.className="btnNPB",button.value="Details",M.dom.addEvent(button,"mousedown",(function(t){t.preventDefault(),c.$refs.dialogItem.openDialog(e)})),M.dom.empty(td),td.appendChild(button),td}},{data:"id",width:100,wordWrap:!1},{data:"item_id",width:"50px",wordWrap:!1},{data:"sku",width:"100px",readOnly:!0,wordWrap:!1},{data:"name",width:"150px",readOnly:!0,wordWrap:!1},{data:"description",width:"230px",wordWrap:!1},{data:"quantity",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0"}},{data:"unit",width:"100px",readOnly:!0,wordWrap:!1},{data:"default_currency_symbol",width:"50px",readOnly:!0,wordWrap:!1,align:"right"},{data:"price",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"discount_rate",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"tax_name",width:"100px",type:"dropdown",height:26,wordWrap:!1,source:function(t,e){e(window.details.$auth.$storage.getLocalStorage("tax"))},strict:!0,filter:!1,allowInvalid:!1},{data:"total",width:"100px",wordWrap:!1,type:"numeric",readOnly:!0,numericFormat:{pattern:"0,0.00"}},{width:"24px",wordWrap:!1,renderer:function(t,td,e,col,r,n,o){var button=null,c=window.details;return(button=document.createElement("button")).type="button",button.innerText="X",button.className="btnDelete",button.value="Details",M.dom.addEvent(button,"mousedown",(function(t){t.preventDefault(),c.removeRow(e)})),M.dom.empty(td),td.appendChild(button),td}}],contextMenu:{callback:function(t,e){var r=window.details;"remove_row"===t&&(r.isInvDetailChanges=!0,r.isInvChanges=!0)}},afterRemoveRow:function(t,e,r,source){window.details.calculateTotal()},beforeRemoveRow:function(t,e,r,source){var n=window.details,o=[];return r.forEach((function(t,e){var r=n.$refs.details.hotInstance.getDataAtCell(t,0);r&&o.push(r)})),1===n.$refs.details.hotInstance.countRows()&&n.$emit("calcTotal",{subTotal:0,amount:0,discountAmount:0,taxDetail:[]}),o.length>0&&n.$emit("removeData",{id:o}),!0},afterChange:function(t,source){var e=window.details;if(t)try{var r=0;t.forEach((function(t){var n=Object(o.a)(t,4),c=(n[0],n[1]),d=n[2],l=n[3];"quantity"!==(r=c)&&"price"!==r&&"discount_rate"!==r&&"tax_name"!==r||d!==l&&e.calculateTotal()}))}catch(t){console.log(t)}}})},selectItems:function(data){var t=data.row,e=data.selected,r=this.$route.query.type,n=this;e.forEach((function(e,o){var c="S"===r.substr(0,1)?e.sale_price:e.purchase_price,d="S"===r.substr(0,1)?e.sell_tax_name:e.buy_tax_name;n.$refs.details.hotInstance.setDataAtRowProp([[t,"name",e.name],[t,"sku",e.code],[t,"unit",e.unit],[t,"description",e.description],[t,"default_currency_symbol",n.form.default_currency_symbol],[t,"item_id",e.id],[t,"price",c],[t,"tax_name",d],[t,"quantity",1]]),t++}))},setDataToDetails:function(data,form){this.updateTableSettings(),this.form=form;var t=void 0!==form.items?form.items:data;this.$refs.details.hotInstance.loadData(t);for(var e=this.$refs.details.hotInstance.countRows(),i=0;i<e;i++)this.$refs.details.hotInstance.setDataAtRowProp(i,"default_currency_symbol",this.form.default_currency_symbol)},calculateTotal:function(){var t=this,e=this.$refs.details.hotInstance.countRows(),r=0,n=0,o=[],c=0,d=0;if(e>0)for(var l=function(i){var e=t.$refs.details.hotInstance.getDataAtRowProp(i,"quantity"),l=t.$refs.details.hotInstance.getDataAtRowProp(i,"price"),j=t.$refs.details.hotInstance.getDataAtRowProp(i,"discount_rate"),m=t.$refs.details.hotInstance.getDataAtRowProp(i,"tax_name"),h=e*l;r+=e*l;var f=parseFloat(j/100*h).toFixed(2);if(n=parseFloat(n)+parseFloat(f),d=h-f,m){var w=0;t.$auth.$storage.getLocalStorage("tax_row").forEach((function(t,e){t.name===m&&(w=parseFloat(t.rate))}));var v=parseFloat(w)/100*d;o.push({name:m,amount:v})}c+=h-f,t.$refs.details.hotInstance.setDataAtRowProp(i,"total",d)},i=0;i<e;i++)l(i);this.$emit("calcTotal",{subTotal:r,amount:c,discountAmount:n,taxDetail:o})},getTaxRate:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.get("/api/financial/taxes/0",{params:{name:t}});case 2:return n=r.sent,r.abrupt("return",n.data.data.rows);case 4:case"end":return r.stop()}}),r)})))()},getDataAtRowPro:function(t,e){return this.$refs.details.hotInstance.getDataAtRowProp(t,e)},countRows:function(){return this.$refs.details.hotInstance.countRows()},checkIfEmptyRow:function(t){return this.$refs.details.hotInstance.isEmptyRow(t)},getAddData:function(){return this.$refs.details.hotInstance.getSourceData()}}},ot=nt,it=r(64),component=Object(it.a)(ot,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("hot-table",{ref:"details",attrs:{root:t.detailsRoot,settings:t.settings}}),t._v(" "),r("LazyInventoryDialogItem",{ref:"dialogItem",attrs:{"view-data":!0,"show-add-btn":!1},on:{selectItems:t.selectItems}})],1)}),[],!1,null,null,null);e.default=component.exports},795:function(t,e,r){var n=r(7),o=r(18),c=r(259).f;n({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:c})},798:function(t,e,r){var map={"./af":609,"./af.js":609,"./ar":610,"./ar-dz":611,"./ar-dz.js":611,"./ar-kw":612,"./ar-kw.js":612,"./ar-ly":613,"./ar-ly.js":613,"./ar-ma":614,"./ar-ma.js":614,"./ar-sa":615,"./ar-sa.js":615,"./ar-tn":616,"./ar-tn.js":616,"./ar.js":610,"./az":617,"./az.js":617,"./be":618,"./be.js":618,"./bg":619,"./bg.js":619,"./bm":620,"./bm.js":620,"./bn":621,"./bn.js":621,"./bo":622,"./bo.js":622,"./br":623,"./br.js":623,"./bs":624,"./bs.js":624,"./ca":625,"./ca.js":625,"./cs":626,"./cs.js":626,"./cv":627,"./cv.js":627,"./cy":628,"./cy.js":628,"./da":629,"./da.js":629,"./de":630,"./de-at":631,"./de-at.js":631,"./de-ch":632,"./de-ch.js":632,"./de.js":630,"./dv":633,"./dv.js":633,"./el":634,"./el.js":634,"./en-SG":635,"./en-SG.js":635,"./en-au":636,"./en-au.js":636,"./en-ca":637,"./en-ca.js":637,"./en-gb":638,"./en-gb.js":638,"./en-ie":639,"./en-ie.js":639,"./en-il":640,"./en-il.js":640,"./en-nz":641,"./en-nz.js":641,"./eo":642,"./eo.js":642,"./es":643,"./es-do":644,"./es-do.js":644,"./es-us":645,"./es-us.js":645,"./es.js":643,"./et":646,"./et.js":646,"./eu":647,"./eu.js":647,"./fa":648,"./fa.js":648,"./fi":649,"./fi.js":649,"./fo":650,"./fo.js":650,"./fr":651,"./fr-ca":652,"./fr-ca.js":652,"./fr-ch":653,"./fr-ch.js":653,"./fr.js":651,"./fy":654,"./fy.js":654,"./ga":655,"./ga.js":655,"./gd":656,"./gd.js":656,"./gl":657,"./gl.js":657,"./gom-latn":658,"./gom-latn.js":658,"./gu":659,"./gu.js":659,"./he":660,"./he.js":660,"./hi":661,"./hi.js":661,"./hr":662,"./hr.js":662,"./hu":663,"./hu.js":663,"./hy-am":664,"./hy-am.js":664,"./id":665,"./id.js":665,"./is":666,"./is.js":666,"./it":667,"./it-ch":668,"./it-ch.js":668,"./it.js":667,"./ja":669,"./ja.js":669,"./jv":670,"./jv.js":670,"./ka":671,"./ka.js":671,"./kk":672,"./kk.js":672,"./km":673,"./km.js":673,"./kn":674,"./kn.js":674,"./ko":675,"./ko.js":675,"./ku":676,"./ku.js":676,"./ky":677,"./ky.js":677,"./lb":678,"./lb.js":678,"./lo":679,"./lo.js":679,"./lt":680,"./lt.js":680,"./lv":681,"./lv.js":681,"./me":682,"./me.js":682,"./mi":683,"./mi.js":683,"./mk":684,"./mk.js":684,"./ml":685,"./ml.js":685,"./mn":686,"./mn.js":686,"./mr":687,"./mr.js":687,"./ms":688,"./ms-my":689,"./ms-my.js":689,"./ms.js":688,"./mt":690,"./mt.js":690,"./my":691,"./my.js":691,"./nb":692,"./nb.js":692,"./ne":693,"./ne.js":693,"./nl":694,"./nl-be":695,"./nl-be.js":695,"./nl.js":694,"./nn":696,"./nn.js":696,"./pa-in":697,"./pa-in.js":697,"./pl":698,"./pl.js":698,"./pt":699,"./pt-br":700,"./pt-br.js":700,"./pt.js":699,"./ro":701,"./ro.js":701,"./ru":702,"./ru.js":702,"./sd":703,"./sd.js":703,"./se":704,"./se.js":704,"./si":705,"./si.js":705,"./sk":706,"./sk.js":706,"./sl":707,"./sl.js":707,"./sq":708,"./sq.js":708,"./sr":709,"./sr-cyrl":710,"./sr-cyrl.js":710,"./sr.js":709,"./ss":711,"./ss.js":711,"./sv":712,"./sv.js":712,"./sw":713,"./sw.js":713,"./ta":714,"./ta.js":714,"./te":715,"./te.js":715,"./tet":716,"./tet.js":716,"./tg":717,"./tg.js":717,"./th":718,"./th.js":718,"./tl-ph":719,"./tl-ph.js":719,"./tlh":720,"./tlh.js":720,"./tr":721,"./tr.js":721,"./tzl":722,"./tzl.js":722,"./tzm":723,"./tzm-latn":724,"./tzm-latn.js":724,"./tzm.js":723,"./ug-cn":725,"./ug-cn.js":725,"./uk":726,"./uk.js":726,"./ur":727,"./ur.js":727,"./uz":728,"./uz-latn":729,"./uz-latn.js":729,"./uz.js":728,"./vi":730,"./vi.js":730,"./x-pseudo":731,"./x-pseudo.js":731,"./yo":732,"./yo.js":732,"./zh-cn":733,"./zh-cn.js":733,"./zh-hk":734,"./zh-hk.js":734,"./zh-tw":735,"./zh-tw.js":735};function n(t){var e=o(t);return r(e)}function o(t){if(!r.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}n.keys=function(){return Object.keys(map)},n.resolve=o,t.exports=n,n.id=798}}]);