(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{1067:function(t,e,o){"use strict";o.r(e);o(24),o(251),o(48),o(4),o(31);var r={name:"MasterPermission",layout:"dashboard",data:function(){return{totalData:0,editedIndex:-1,loadNewBtn:!1,submitLoad:!1,dialogWindow:!1,statusProcessing:"insert",dialog:!1,dialogPermission:!1,message:!1,loading:!0,insertDivision:!0,insert:!0,documentStatus:[],itemSearch:[],searchStatus:"",searchItem:"",search:"",items:[{text:"Edit",action:"edit"},{text:"Delete",action:"delete"}],itemText:"",itemAction:"",loadingPermission:!0,allData:[],dataParent:[],itemApps:[],itemRole:[],department:{},form:{id:null,is_crud:"N",order_line:null,has_route:"N",has_child:"N",route_name:"N",icon:null,menu_name:null,parent_name:null,app_name:null,name:null,old_name:null,index:"Y",store:"",edits:"",erase:"",role:[]},defaultItem:{id:null,is_crud:"N",order_line:null,has_route:"N",has_child:"N",route_name:"N",icon:null,menu_name:null,parent_name:null,app_name:null,name:null,old_name:null,index:"Y",store:"",edits:"",erase:"",role:[]},options:{},headers:[{text:"Name",value:"menu_name"},{text:"Parent Name",value:"parent_name"},{text:"Route",value:"route_name"},{text:"Has Child",value:"has_child"},{text:"Is CRUD",value:"is_crud"},{text:"Order Line",value:"order_line"},{text:"Action",value:"ACTIONS",align:"center"}]}},head:function(){return{title:"Master Permissions"}},computed:{formTitle:function(){return-1===this.editedIndex?"New":"Edit"}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},mounted:function(){this.getDataFromApi(),this.getRole(),this.itemText=this.items[0].text,this.itemAction=this.items[0].action},methods:{getRole:function(){var t=this;this.$axios.get("/api/master/roles").then((function(e){t.itemRole=e.data.data.simple}))},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.filters=data.filters,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0;this.$axios.get("/api/master/permissions",{params:{options:this.options}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.dataParent=e.data.data.parent})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},newData:function(){this.dialog=!0,this.statusProcessing="insert",this.form=Object.assign({},this.defaultItem),this.message=!1},actions:function(t,e){"edit"===t?this.editItem(e):this.deleteItem(e)},deleteItem:function(t){var e=this;this.$axios.delete("/api/master/permissions/"+t.menu_name).then((function(t){e.getDataFromApi(),e.$nuxt.$emit("getMenu","nice payload")}))},editItem:function(t){var e=this;this.editedIndex=this.allData.indexOf(t),this.form=Object.assign({},t),this.statusProcessing="update",this.$axios.get("/api/master/permissions/"+this.form.parent_id,{params:{menu_name:this.form.menu_name}}).then((function(t){var form=Object.assign({},t.data.data.rows);form.old_name=t.data.data.rows.menu_name,form.role=JSON.parse(t.data.data.rows.role_name),setTimeout((function(){return e.form=Object.assign({},form)}),150)})),this.dialog=!0,this.insert=!1},openDialogPermission:function(t){this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},t),this.getPermissionRole(t)},getPermissionRole:function(t){var e=this;this.$axios.get("/api/master/permission-role",{params:{role:t.name}}).then((function(t){e.$refs.childDetails.setDataToDetails(t.data.data.rows)})).finally((function(t){e.loadingPermission=!1}))},saveRolePermission:function(){var t=this;this.loadingPermission=!0;var details=this.$refs.childDetails.getAddData();this.$axios.post("/api/master/permission-role",{details:details,role:this.form.name}).then((function(e){t.$swal({icon:"success",title:"Success",text:e.data.message}),t.getPermissionRole(t.form)})).catch((function(e){t.$swal({type:"error",title:"Error",text:e.response.data.message})})).finally((function(e){t.loadingPermission=!1}))},close:function(){var t=this;this.dialog=!1,this.statusProcessing="insert",setTimeout((function(){t.form=Object.assign({},t.defaultItem),t.editedIndex=-1}),300)},save:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=this,form=this.form,o=this.statusProcessing;"insert"===o?(this.store("post","/api/master/permissions",form,"insert",t),e.submitLoad=!1):"update"===o&&(this.store("put","/api/master/permissions/"+this.form.parent_id,form,"update",t),e.submitLoad=!1)},store:function(t,e,data,o){var r=this,n=this;n.submitLoad=!0,this.$axios({method:t,url:e,data:data}).then((function(t){"Error"===t.data.status?(r.$swal({type:"error",title:"Error",text:t.data.message}),n.submitLoad=!1):(r.dialog=!1,r.message=t.data.message,setTimeout((function(){return r.message=!1}),8e3),r.$nuxt.$emit("getMenu","nice payload"),r.getDataFromApi())})).catch((function(t){r.$swal({type:"error",title:"Error",text:t.response.data.message}),n.submitLoad=!1}))},changeCrud:function(t){"Y"===t?(this.form.index="Y",this.form.store="Y",this.form.edits="Y",this.form.erase="Y"):(this.form.index="",this.form.store="",this.form.edits="",this.form.erase="")}}},n=r,l=o(47),d=o(54),m=o.n(d),c=o(153),h=o(239),v=o(108),f=o(588),_=o(1050),x=o(546),k=o(527),w=o(566),y=o(578),C=o(234),D=o(561),P=o(235),$=o(155),N=o(53),I=o(529),S=o(801),V=o(802),L=o(606),R=o(543),T=o(523),component=Object(l.a)(n,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-layout",[o("v-flex",{attrs:{sm12:""}},[o("div",{staticClass:"mt-0"},[o("v-data-table",{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,loading:t.loading,"footer-props":{"items-per-page-options":[20,50,100,-1]},dense:""},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"top",fn:function(){return[o("LazySetupBackList"),t._v(" "),o("LazyMainToolbar",{attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,filter:!1,title:"Master Permissions"},on:{emitData:t.emitData,newData:t.newData}})]},proxy:!0},{key:"item.ACTIONS",fn:function(e){var r=e.item;return[o("v-btn",{staticClass:"font-weight-bold text-right",attrs:{color:"secondary",text:"",small:""},on:{click:function(e){return t.actions(t.itemAction,r)}}},[t._v("\n              "+t._s(t.itemText)+"\n            ")]),t._v(" "),o("v-menu",{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,n=e.attrs;return[o("v-btn",t._g(t._b({attrs:{color:"black",dark:"",icon:""}},"v-btn",n,!1),r),[o("v-icon",[t._v("mdi-menu-down")])],1)]}}],null,!0)},[t._v(" "),o("v-list",t._l(t.items,(function(e,i){return o("v-list-item",{key:i,on:{click:function(o){return t.actions(e.action,r)}}},[o("v-list-item-content",[o("v-list-item-title",[t._v(t._s(e.text))])],1)],1)})),1)],1)]}}],null,!0)})],1)]),t._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"600px",transition:"dialog-top-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-card",[o("v-card-title",[o("span",{staticClass:"headline"},[t._v(t._s(t.formTitle))]),t._v(" "),o("v-spacer"),t._v(" "),o("v-btn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(e){t.dialog=!1}}},[o("v-icon",[t._v("mdi-close-circle")])],1)],1),t._v(" "),o("v-divider"),t._v(" "),o("v-card-text",[o("v-form",[o("v-layout",{attrs:{wrap:""}},[o("v-flex",{staticClass:"d-flex",attrs:{md12:""}},[o("v-layout",{attrs:{wrap:""}},[o("v-flex",{staticClass:"pa-1 mt-1",attrs:{xs12:""}},[o("v-select",{attrs:{items:t.itemRole,chips:"","deletable-chips":"","small-chips":"",label:"Role",multiple:"",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}})],1),t._v(" "),o("v-flex",{staticClass:"pa-1 mt-1",attrs:{xs12:""}},[o("v-select",{attrs:{items:t.dataParent,label:"Parent Name",outlined:"",dense:"","hide-details":"auto",clearable:""},model:{value:t.form.parent_name,callback:function(e){t.$set(t.form,"parent_name",e)},expression:"form.parent_name"}})],1),t._v(" "),o("v-flex",{staticClass:"pa-1 mt-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Name",placeholder:"Name",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.menu_name,callback:function(e){t.$set(t.form,"menu_name",e)},expression:"form.menu_name"}})],1),t._v(" "),o("v-flex",{staticClass:"pa-1 mt-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Icon",placeholder:"Icon",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.icon,callback:function(e){t.$set(t.form,"icon",e)},expression:"form.icon"}})],1),t._v(" "),o("v-flex",{staticClass:"pa-1 mt-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Order Line",placeholder:"Order Line",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.order_line,callback:function(e){t.$set(t.form,"order_line",e)},expression:"form.order_line"}})],1),t._v(" "),o("v-flex",{staticClass:"pa-1 mt-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Has Route"},model:{value:t.form.has_route,callback:function(e){t.$set(t.form,"has_route",e)},expression:"form.has_route"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"primary"}}),t._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"primary"}})],1)],1),t._v(" "),"Y"===t.form.has_route?o("v-flex",{staticClass:"pa-1",attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Route Name",placeholder:"Route Name",outlined:"",dense:"","hide-details":"auto"},model:{value:t.form.route_name,callback:function(e){t.$set(t.form,"route_name",e)},expression:"form.route_name"}})],1):t._e(),t._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Has Child"},model:{value:t.form.has_child,callback:function(e){t.$set(t.form,"has_child",e)},expression:"form.has_child"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"primary"}}),t._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"primary"}})],1)],1),t._v(" "),o("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:"","hide-details":"auto",label:"Is CRUD"},model:{value:t.form.is_crud,callback:function(e){t.$set(t.form,"is_crud",e)},expression:"form.is_crud"}},[o("v-radio",{attrs:{label:"Yes",value:"Y",color:"primary"},on:{change:function(e){return t.changeCrud("Y")}}}),t._v(" "),o("v-radio",{attrs:{label:"No",value:"N",color:"primary"},on:{change:function(e){return t.changeCrud("N")}}})],1)],1),t._v(" "),o("v-flex",{staticClass:"pa-1 d-flex",attrs:{xs12:""}},[o("span",{staticClass:"font-weight-medium"},[t._v("Ability")])]),t._v(" "),o("v-flex",{staticClass:"pa-1 d-flex",attrs:{xs12:""}},[o("v-checkbox",{attrs:{value:t.form.index,label:"Index",color:"primary","hide-details":""},model:{value:t.form.index,callback:function(e){t.$set(t.form,"index",e)},expression:"form.index"}}),t._v(" "),o("v-checkbox",{attrs:{value:t.form.store,label:"Store",color:"primary","hide-details":""},model:{value:t.form.store,callback:function(e){t.$set(t.form,"store",e)},expression:"form.store"}}),t._v(" "),o("v-checkbox",{attrs:{value:t.form.edits,label:"Edits",color:"primary","hide-details":""},model:{value:t.form.edits,callback:function(e){t.$set(t.form,"edits",e)},expression:"form.edits"}}),t._v(" "),o("v-checkbox",{attrs:{value:t.form.erase,label:"Erase",color:"primary","hide-details":""},model:{value:t.form.erase,callback:function(e){t.$set(t.form,"erase",e)},expression:"form.erase"}})],1)],1)],1)],1)],1)],1),t._v(" "),o("v-divider"),t._v(" "),o("v-card-actions",[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{color:"primary",dark:"",small:"",loading:t.submitLoad},on:{click:function(e){return t.save()}}},[t._v("\n            Save\n          ")])],1)],1)],1),t._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"1000px"},model:{value:t.dialogPermission,callback:function(e){t.dialogPermission=e},expression:"dialogPermission"}},[o("v-card",{attrs:{loading:t.loadingPermission}},[o("v-card-title",[o("span",{staticClass:"font-weight-medium"},[t._v("Role Permission")])]),t._v(" "),o("v-card-text",[o("div",{staticClass:"scroll-container"},[o("LazyMasterPermissionList",{ref:"childDetails"})],1)]),t._v(" "),o("v-card-actions",[o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"blue darken-1"},on:{click:function(e){return t.$refs.childDetails.addLine()}}},[o("v-icon",{attrs:{small:""}},[t._v(" mdi-plus")])],1),t._v(" "),o("v-spacer"),t._v(" "),o("v-btn",{attrs:{color:"red darken-1",dark:"",small:""},on:{click:function(e){t.dialogPermission=!1}}},[t._v("\n            close\n          ")]),t._v(" "),o("v-btn",{attrs:{color:"green darken-1",dark:"",small:"",loading:t.loadingPermission},on:{click:function(e){return t.saveRolePermission()}}},[t._v("\n            Save\n          ")])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;m()(component,{VBtn:c.a,VCard:h.a,VCardActions:v.a,VCardText:v.b,VCardTitle:v.c,VCheckbox:f.a,VDataTable:_.a,VDialog:x.a,VDivider:k.a,VFlex:w.a,VForm:y.a,VIcon:C.a,VLayout:D.a,VList:P.a,VListItem:$.a,VListItemContent:N.a,VListItemTitle:N.c,VMenu:I.a,VRadio:S.a,VRadioGroup:V.a,VSelect:L.a,VSpacer:R.a,VTextField:T.a})}}]);