(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1010:function(t,e,r){"use strict";r.r(e);var n=r(28),o=r(23),c=(r(84),r(4),r(10),r(31),r(9),r(63),r(255),r(794)),base=(r(792),r(820)),l=r(764),d=r(555),j=r(930);r(29);var m,h,f,w,v,y,R,_=r(801),I=r(799),x=r(541),k=r(590),data=r(601),D=r(828),O=r(598),$=r(562),E=r(546),z=r(553),object=r(540),C=r(584),T=r(581),P=r(542),A=r(563),F=r(579),S=r(588),W=r(589),N=r(585),U=r(599),H=r(1005);Object(l.a)(),y=base.a,(R="undefined"!=typeof window&&window.jQuery)&&(R.fn.handsontable=function(t){var output,e=this.first(),r=e.data("handsontable");if("string"!=typeof t){var n=t||{};return r?r.updateSettings(n):(r=new y.Core(e[0],n),e.data("handsontable",r),r.init()),e}if(r){if(void 0===r[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var o,c=arguments.length,l=new Array(c>1?c-1:0),d=1;d<c;d++)l[d-1]=arguments[d];output=(o=r[t]).call.apply(o,[r].concat(l)),"destroy"===t&&e.removeData()}return output}),base.a.__GhostTable=_.a,base.a._getListenersCounter=d.b,base.a._getRegisteredMapsCounter=j.b,base.a.EventManager=d.a;var L=[x,k,data,D,O,$,E,z,object,C,T,I],M=[P,A];base.a.helper={},base.a.dom={},x.arrayEach(L,(function(t){x.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(base.a.helper[e]=t[e])}))})),x.arrayEach(M,(function(t){x.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(base.a.dom[e]=t[e])}))})),base.a.cellTypes=null!==(m=base.a.cellTypes)&&void 0!==m?m:{},x.arrayEach(Object(N.b)(),(function(t){base.a.cellTypes[t]=Object(N.a)(t)})),base.a.cellTypes.registerCellType=N.d,base.a.cellTypes.getCellType=N.a,base.a.editors=null!==(h=base.a.editors)&&void 0!==h?h:{},x.arrayEach(Object(F.c)(),(function(t){base.a.editors["".concat(C.toUpperCaseFirst(t),"Editor")]=Object(F.a)(t)})),base.a.editors.registerEditor=F.e,base.a.editors.getEditor=F.a,base.a.renderers=null!==(f=base.a.renderers)&&void 0!==f?f:{},x.arrayEach(Object(S.a)(),(function(t){var e=Object(S.b)(t);"base"===t&&(base.a.renderers.cellDecorator=e),base.a.renderers["".concat(C.toUpperCaseFirst(t),"Renderer")]=e})),base.a.renderers.registerRenderer=S.d,base.a.renderers.getRenderer=S.b,base.a.validators=null!==(w=base.a.validators)&&void 0!==w?w:{},x.arrayEach(Object(W.a)(),(function(t){base.a.validators["".concat(C.toUpperCaseFirst(t),"Validator")]=Object(W.b)(t)})),base.a.validators.registerValidator=W.d,base.a.validators.getValidator=W.b,base.a.plugins=null!==(v=base.a.plugins)&&void 0!==v?v:{},x.arrayEach(Object(U.b)(),(function(t){base.a.plugins[t]=Object(U.a)(t)})),base.a.plugins["".concat(C.toUpperCaseFirst(H.a.PLUGIN_KEY),"Plugin")]=H.a,base.a.plugins.registerPlugin=U.d,base.a.plugins.getPlugin=U.a;var G=base.a;r(800);Object(l.a)();var V={name:"TableDetail",components:{HotTable:c.a},data:function(){return{settings:{licenseKey:"non-commercial-and-evaluation"},detailsRoot:"detailsRoot",colHeaders:[],form:{}}},created:function(){this.setInstance()},methods:{setInstance:function(){window.details=this},removeRow:function(t){this.$refs.details.hotInstance.alter("remove_row",t)},addLine:function(){var t=this.$refs.details.hotInstance.countRows();this.$refs.details.hotInstance.alter("insert_row",t+1)},updateTableSettings:function(header){this.$refs.details.hotInstance.updateSettings({currentRowClassName:"currentRow",currentColClassName:"currentCol",startRows:2,manualColumnFreeze:!0,currData:{},rowHeaders:!0,manualColumnResize:!0,rowHeights:28,manualRowResize:!0,filters:!0,autoRowSize:!1,autoColumnSize:!0,viewportRowRenderingOffset:1e3,viewportColumnRenderingOffset:100,colWidths:80,dropdownMenu:!0,columnSorting:!0,persistentState:!0,width:"100%",stretchH:"all",hiddenColumns:{copyPasteEnabled:!1,indicator:!1,columns:[1,2,3]},colHeaders:["","Id","Item ID","Item Code","Item Name","Description","Qty","Units","Curency","Unit Price","Discount","Tax","Amount",""],columns:[{width:"24px",wordWrap:!1,renderer:function(t,td,e,col,r,n,o){var button=null,c=window.details;return(button=document.createElement("button")).type="button",button.innerText=">",button.className="btnNPB",button.value="Details",G.dom.addEvent(button,"mousedown",(function(t){t.preventDefault(),c.$refs.dialogItem.openDialog(e)})),G.dom.empty(td),td.appendChild(button),td}},{data:"id",width:100,wordWrap:!1},{data:"item_id",width:"50px",wordWrap:!1},{data:"sku",width:"100px",readOnly:!0,wordWrap:!1},{data:"name",width:"150px",readOnly:!0,wordWrap:!1},{data:"description",width:"230px",wordWrap:!1},{data:"quantity",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0"}},{data:"unit",width:"100px",readOnly:!0,wordWrap:!1},{data:"default_currency_symbol",width:"50px",readOnly:!0,wordWrap:!1,align:"right"},{data:"price",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"discount_rate",width:"100px",wordWrap:!1,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"tax_name",width:"100px",type:"dropdown",height:26,wordWrap:!1,source:function(t,e){e(window.details.$auth.$storage.getLocalStorage("tax"))},strict:!0,filter:!1,allowInvalid:!1},{data:"total",width:"100px",wordWrap:!1,type:"numeric",readOnly:!0,numericFormat:{pattern:"0,0.00"}},{width:"24px",wordWrap:!1,renderer:function(t,td,e,col,r,n,o){var button=null,c=window.details;return(button=document.createElement("button")).type="button",button.innerText="X",button.className="btnDelete",button.value="Details",G.dom.addEvent(button,"mousedown",(function(t){t.preventDefault(),c.removeRow(e)})),G.dom.empty(td),td.appendChild(button),td}}],contextMenu:{callback:function(t,e){var r=window.details;"remove_row"===t&&(r.isInvDetailChanges=!0,r.isInvChanges=!0)}},afterRemoveRow:function(t,e,r,source){window.details.calculateTotal()},beforeRemoveRow:function(t,e,r,source){var n=window.details,o=[];return r.forEach((function(t,e){var r=n.$refs.details.hotInstance.getDataAtCell(t,0);r&&o.push(r)})),1===n.$refs.details.hotInstance.countRows()&&n.$emit("calcTotal",{subTotal:0,amount:0,discountAmount:0,taxDetail:[]}),o.length>0&&n.$emit("removeData",{id:o}),!0},afterChange:function(t,source){var e=window.details;if(t)try{var r=0;t.forEach((function(t){var n=Object(o.a)(t,4),c=(n[0],n[1]),l=n[2],d=n[3];"quantity"!==(r=c)&&"price"!==r&&"discount_rate"!==r&&"tax_name"!==r||l!==d&&e.calculateTotal()}))}catch(t){console.log(t)}}})},selectItems:function(data){var t=data.row,e=data.selected,r=this.$route.query.type,n=this;e.forEach((function(e,o){var c="S"===r.substr(0,1)?e.sale_price:e.purchase_price,l="S"===r.substr(0,1)?e.sell_tax_name:e.buy_tax_name;n.$refs.details.hotInstance.setDataAtRowProp([[t,"name",e.name],[t,"sku",e.code],[t,"unit",e.unit],[t,"description",e.description],[t,"default_currency_symbol",n.form.default_currency_symbol],[t,"item_id",e.id],[t,"price",c],[t,"tax_name",l],[t,"quantity",1]]),t++}))},setDataToDetails:function(data,form){this.updateTableSettings(),this.form=form;var t=void 0!==form.items?form.items:data;this.$refs.details.hotInstance.loadData(t);for(var e=this.$refs.details.hotInstance.countRows(),i=0;i<e;i++)this.$refs.details.hotInstance.setDataAtRowProp(i,"default_currency_symbol",this.form.default_currency_symbol)},calculateTotal:function(){var t=this,e=this.$refs.details.hotInstance.countRows(),r=0,n=0,o=[],c=0,l=0;if(e>0)for(var d=function(i){var e=t.$refs.details.hotInstance.getDataAtRowProp(i,"quantity"),d=t.$refs.details.hotInstance.getDataAtRowProp(i,"price"),j=t.$refs.details.hotInstance.getDataAtRowProp(i,"discount_rate"),m=t.$refs.details.hotInstance.getDataAtRowProp(i,"tax_name"),h=e*d;r+=e*d;var f=parseFloat(j/100*h).toFixed(2);if(n=parseFloat(n)+parseFloat(f),l=h-f,m){var w=0;t.$auth.$storage.getLocalStorage("tax_row").forEach((function(t,e){t.name===m&&(w=parseFloat(t.rate))}));var v=parseFloat(w)/100*l;o.push({name:m,amount:v})}c+=h-f,t.$refs.details.hotInstance.setDataAtRowProp(i,"total",l)},i=0;i<e;i++)d(i);this.$emit("calcTotal",{subTotal:r,amount:c,discountAmount:n,taxDetail:o})},getTaxRate:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.get("/api/financial/taxes/0",{params:{name:t}});case 2:return n=r.sent,r.abrupt("return",n.data.data.rows);case 4:case"end":return r.stop()}}),r)})))()},getDataAtRowPro:function(t,e){return this.$refs.details.hotInstance.getDataAtRowProp(t,e)},countRows:function(){return this.$refs.details.hotInstance.countRows()},checkIfEmptyRow:function(t){return this.$refs.details.hotInstance.isEmptyRow(t)},getAddData:function(){return this.$refs.details.hotInstance.getSourceData()}}},J=V,K=r(64),component=Object(K.a)(J,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("hot-table",{ref:"details",attrs:{root:t.detailsRoot,settings:t.settings}}),t._v(" "),r("LazyInventoryDialogItem",{ref:"dialogItem",attrs:{"view-data":!0,"show-add-btn":!1},on:{selectItems:t.selectItems}})],1)}),[],!1,null,null,null);e.default=component.exports},792:function(t,e,r){var n=r(7),o=r(18),c=r(259).f;n({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:c})},795:function(t,e,r){var map={"./af":607,"./af.js":607,"./ar":608,"./ar-dz":609,"./ar-dz.js":609,"./ar-kw":610,"./ar-kw.js":610,"./ar-ly":611,"./ar-ly.js":611,"./ar-ma":612,"./ar-ma.js":612,"./ar-sa":613,"./ar-sa.js":613,"./ar-tn":614,"./ar-tn.js":614,"./ar.js":608,"./az":615,"./az.js":615,"./be":616,"./be.js":616,"./bg":617,"./bg.js":617,"./bm":618,"./bm.js":618,"./bn":619,"./bn.js":619,"./bo":620,"./bo.js":620,"./br":621,"./br.js":621,"./bs":622,"./bs.js":622,"./ca":623,"./ca.js":623,"./cs":624,"./cs.js":624,"./cv":625,"./cv.js":625,"./cy":626,"./cy.js":626,"./da":627,"./da.js":627,"./de":628,"./de-at":629,"./de-at.js":629,"./de-ch":630,"./de-ch.js":630,"./de.js":628,"./dv":631,"./dv.js":631,"./el":632,"./el.js":632,"./en-SG":633,"./en-SG.js":633,"./en-au":634,"./en-au.js":634,"./en-ca":635,"./en-ca.js":635,"./en-gb":636,"./en-gb.js":636,"./en-ie":637,"./en-ie.js":637,"./en-il":638,"./en-il.js":638,"./en-nz":639,"./en-nz.js":639,"./eo":640,"./eo.js":640,"./es":641,"./es-do":642,"./es-do.js":642,"./es-us":643,"./es-us.js":643,"./es.js":641,"./et":644,"./et.js":644,"./eu":645,"./eu.js":645,"./fa":646,"./fa.js":646,"./fi":647,"./fi.js":647,"./fo":648,"./fo.js":648,"./fr":649,"./fr-ca":650,"./fr-ca.js":650,"./fr-ch":651,"./fr-ch.js":651,"./fr.js":649,"./fy":652,"./fy.js":652,"./ga":653,"./ga.js":653,"./gd":654,"./gd.js":654,"./gl":655,"./gl.js":655,"./gom-latn":656,"./gom-latn.js":656,"./gu":657,"./gu.js":657,"./he":658,"./he.js":658,"./hi":659,"./hi.js":659,"./hr":660,"./hr.js":660,"./hu":661,"./hu.js":661,"./hy-am":662,"./hy-am.js":662,"./id":663,"./id.js":663,"./is":664,"./is.js":664,"./it":665,"./it-ch":666,"./it-ch.js":666,"./it.js":665,"./ja":667,"./ja.js":667,"./jv":668,"./jv.js":668,"./ka":669,"./ka.js":669,"./kk":670,"./kk.js":670,"./km":671,"./km.js":671,"./kn":672,"./kn.js":672,"./ko":673,"./ko.js":673,"./ku":674,"./ku.js":674,"./ky":675,"./ky.js":675,"./lb":676,"./lb.js":676,"./lo":677,"./lo.js":677,"./lt":678,"./lt.js":678,"./lv":679,"./lv.js":679,"./me":680,"./me.js":680,"./mi":681,"./mi.js":681,"./mk":682,"./mk.js":682,"./ml":683,"./ml.js":683,"./mn":684,"./mn.js":684,"./mr":685,"./mr.js":685,"./ms":686,"./ms-my":687,"./ms-my.js":687,"./ms.js":686,"./mt":688,"./mt.js":688,"./my":689,"./my.js":689,"./nb":690,"./nb.js":690,"./ne":691,"./ne.js":691,"./nl":692,"./nl-be":693,"./nl-be.js":693,"./nl.js":692,"./nn":694,"./nn.js":694,"./pa-in":695,"./pa-in.js":695,"./pl":696,"./pl.js":696,"./pt":697,"./pt-br":698,"./pt-br.js":698,"./pt.js":697,"./ro":699,"./ro.js":699,"./ru":700,"./ru.js":700,"./sd":701,"./sd.js":701,"./se":702,"./se.js":702,"./si":703,"./si.js":703,"./sk":704,"./sk.js":704,"./sl":705,"./sl.js":705,"./sq":706,"./sq.js":706,"./sr":707,"./sr-cyrl":708,"./sr-cyrl.js":708,"./sr.js":707,"./ss":709,"./ss.js":709,"./sv":710,"./sv.js":710,"./sw":711,"./sw.js":711,"./ta":712,"./ta.js":712,"./te":713,"./te.js":713,"./tet":714,"./tet.js":714,"./tg":715,"./tg.js":715,"./th":716,"./th.js":716,"./tl-ph":717,"./tl-ph.js":717,"./tlh":718,"./tlh.js":718,"./tr":719,"./tr.js":719,"./tzl":720,"./tzl.js":720,"./tzm":721,"./tzm-latn":722,"./tzm-latn.js":722,"./tzm.js":721,"./ug-cn":723,"./ug-cn.js":723,"./uk":724,"./uk.js":724,"./ur":725,"./ur.js":725,"./uz":726,"./uz-latn":727,"./uz-latn.js":727,"./uz.js":726,"./vi":728,"./vi.js":728,"./x-pseudo":729,"./x-pseudo.js":729,"./yo":730,"./yo.js":730,"./zh-cn":731,"./zh-cn.js":731,"./zh-hk":732,"./zh-hk.js":732,"./zh-tw":733,"./zh-tw.js":733};function n(t){var e=o(t);return r(e)}function o(t){if(!r.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}n.keys=function(){return Object.keys(map)},n.resolve=o,t.exports=n,n.id=795}}]);